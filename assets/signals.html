<!-- a signal -->

<polymer-element
    name="reactive-signal"
    attributes="name value" >

<template></template>

<script>

Polymer({
    name: null,
    value: null,
    domReady: function () {
        this.setAttribute("id", "signal-" + this.name)
    },
    update: function () {
        // console.log("signal updated", a,b,c)
        this.fire("signal-updated", {
            name: this.name,
            source: this,
            value: this.value
        })
    }
})

</script>

</polymer-element>


<polymer-element
    name="stop-propagation"
    attributes="name" >

<script>
    Polymer({
        names: [],
        domReady: function () {
            var self = this
            this.addEventListener("signal-updated", function (ev) {
                if (self.names.indexOf(ev.detail.name) > 0) {
                    ev.stopPorpagation()
                }
            })
        }
    })

</script>

</polymer-element>


<polymer-element
    name="signal-transport"
    attributes="signalId name" >

<template><content></content></template>

<script>
    Polymer({
        signalId: null,
        name: null,
        domReady: function () {
            var self = this
            this.addEventListener("signal-updated", function (ev) {
                if (self.name == ev.detail.name) {
                    self.fire("signal-transport", {
                        signalId: self.signalId,
                        value: ev.detail.value
                    }) // bail
                }
            })
        }
    })
</script>

</polymer-element>


<polymer-element
    name="sample-signals"
    attributes="signals triggers"
    extends="reactive-signal" >

<template><content></content></template>

<script>
Polymer({
    signals: [],
    triggers: [],
    domReady: function () {
        var self = this
        this.value = {}
        this.addEventListener("signal-updated", function (ev) {
            if (self.triggers.indexOf(ev.detail.name) >= 0) {
                var result = {}
                for(var i=0, l=self.signals.length; i < l; i++) {
                    var s = self.signals[i]
                    result[s] = self.querySelector("#signal-" + s).value
                }
                self.value = result
                self.update()
            }
        })
        this.super()
    }
})
</script>

</polymer-element>
