<!-- a signal -->

<polymer-element
    name="reactive-signal"
    attributes="name value" >

<tempmlate></template>

<script>

Polymer({
    name: null,
    value: null,
    valueChanged: function (a, b, c) {
        // console.log("signal updated", a,b,c)
        this.fire("signal-updated", {
            name: this.name,
            source: this,
            value: this.value
        })
    }
})

</script>

</polymer-element>


<polymer-element
    name="stop-propagation"
    attributes="name" >

<script>
    Polymer({
        names: [],
        domReady: function () {
            this.addEventListener("signal-updated", function (ev) {
                if (name === ev.detail.name < 0) {
                    ev.stopPorpagation()
                }
            })
        }
    })

</script>

</polymer-element>


<polymer-element
    name="signal-transport"
    attributes="signalId name" >

<template><content></content></template>

<script>
    Polymer({
        signalId: null,
        name: null,
        domReady: function () {
            var self = this
            this.addEventListener("signal-updated", function (ev) {
                if (self.name == ev.detail.name) {
                    this.fire("signal-transport", {
                        signalId: self.signalId,
                        value: ev.detail.value
                    }) // bail
                }
            })
        }
    })
</script>

</polymer-element>


<polymer-element
    name="state-signal"
    attributes="attr trigger"
    extends="reactive-signal" >
<template></template>

<script>

Polymer({
    attr: "value",
    trigger: "change",
    elem: null,
    domReady: function () {
        //console.log("Setting up attr signal dom handler")
        var self = this
        this.elem = this.elem || this.parentNode
        var elem = this.elem
        this.elem.addEventListener(this.trigger, function () {
            self.value = elem[self.attr] || elem.getAttribute(self.attr)
        })
        this.super()
    }
})

</script>

</polymer-element>
