<polymer-element
    name="watch-state"
    attributes="attr trigger"
    extends="reactive-signal" >
<template></template>

<script>

Polymer({
    attr: "value",
    trigger: "change",
    elem: null,
    domReady: function () {
        //console.log("Setting up attr signal dom handler")
        var self = this
        this.elem = this.elem || this.parentNode
        var elem = this.elem
        this.elem.addEventListener(this.trigger, function () {
            self.value = elem[self.attr] || elem.getAttribute(self.attr)
            self.update()
        })
        this.super()
    }
})

</script>

</polymer-element>

<polymer-element
    name="clickable-behaviour"
    attributes="name buttons"
    extends="reactive-signal" >

<template><content></content></template>

<script>
Polymer({
    buttons: [1],
    domReady: function () {
        var self = this
        if (this.buttons.indexOf(2) >= 0) {
            this.addEventListener("contextmenu", function (ev) {
                ev.preventDefault()
                self.value = 2
                self.update()
                return false
            })
        }
        if (this.buttons.indexOf(1) >= 0 || this.buttons.indexOf(3) >= 0) {
            this.addEventListener("click", function (ev) {
                if (ev.button == 0 && this.buttons.indexOf(1) >= 0) {
                    // Left click
                    self.value = 1
                    self.update()
                } else if(ev.button == 1 && this.buttons.indexOf(3) >= 0) {
                    // Right click
                    self.value = 3
                    self.update()
                }
            })
        }
    }
})
</script>

</polymer-element>
